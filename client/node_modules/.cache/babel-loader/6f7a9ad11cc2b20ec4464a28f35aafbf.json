{"ast":null,"code":"const crypto = require(\"crypto\");\n\nconst secret = \"pppppppppppppppppppppppppppppppp\";\n\nconst encrypt = password => {\n  const iv = Buffer.from(crypto.randomBytes(16));\n  const cipher = crypto.createCipheriv('aes-256-ctr', Buffer.from(secret), iv);\n  const encryptedPass = Buffer.concat([cipher.update(password), cipher.final()]);\n  return {\n    iv: iv.toString(\"hex\"),\n    password: encryptedPass.toString(\"hex\")\n  };\n};\n\nconst decrypt = encryption => {\n  const decipher = crypto.createDecipheriv('aes-256-ctr', Buffer.from(secret), Buffer.from(encryption.iv, \"hex\"));\n  const decpass = Buffer.concat([decipher.update(Buffer.from(encryption.password, \"hex\")), decipher.final()]);\n  return {\n    a: decpass.toString(),\n    b: encryption.userna\n  };\n};\n\nmodule.exports = {\n  encrypt,\n  decrypt\n};","map":{"version":3,"names":["crypto","require","secret","encrypt","password","iv","Buffer","from","randomBytes","cipher","createCipheriv","encryptedPass","concat","update","final","toString","decrypt","encryption","decipher","createDecipheriv","decpass","a","b","userna","module","exports"],"sources":["C:/Users/admin/OneDrive/Desktop/PassMan-main/ISM/client/src/server/Encryption.js"],"sourcesContent":["const crypto = require(\"crypto\");\nconst secret = \"pppppppppppppppppppppppppppppppp\";\n\nconst encrypt = (password) => {\n    const iv = Buffer.from(crypto.randomBytes(16));\n    const cipher = crypto.createCipheriv('aes-256-ctr',Buffer.from(secret),iv);\n\n    const encryptedPass = Buffer.concat([cipher.update(password),cipher.final()]);\n\n    return {iv: iv.toString(\"hex\"), password: encryptedPass.toString(\"hex\"),};\n};\n\nconst decrypt = (encryption) => {\n    const decipher = crypto.createDecipheriv('aes-256-ctr',Buffer.from(secret),Buffer.from(encryption.iv, \"hex\"));\n\n    const decpass = Buffer.concat([decipher.update(Buffer.from(encryption.password,\"hex\")),decipher.final()]);\n\n    return {a:decpass.toString() , b:encryption.userna};\n};\n\nmodule.exports = {encrypt , decrypt};"],"mappings":"AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;;AACA,MAAMC,MAAM,GAAG,kCAAf;;AAEA,MAAMC,OAAO,GAAIC,QAAD,IAAc;EAC1B,MAAMC,EAAE,GAAGC,MAAM,CAACC,IAAP,CAAYP,MAAM,CAACQ,WAAP,CAAmB,EAAnB,CAAZ,CAAX;EACA,MAAMC,MAAM,GAAGT,MAAM,CAACU,cAAP,CAAsB,aAAtB,EAAoCJ,MAAM,CAACC,IAAP,CAAYL,MAAZ,CAApC,EAAwDG,EAAxD,CAAf;EAEA,MAAMM,aAAa,GAAGL,MAAM,CAACM,MAAP,CAAc,CAACH,MAAM,CAACI,MAAP,CAAcT,QAAd,CAAD,EAAyBK,MAAM,CAACK,KAAP,EAAzB,CAAd,CAAtB;EAEA,OAAO;IAACT,EAAE,EAAEA,EAAE,CAACU,QAAH,CAAY,KAAZ,CAAL;IAAyBX,QAAQ,EAAEO,aAAa,CAACI,QAAd,CAAuB,KAAvB;EAAnC,CAAP;AACH,CAPD;;AASA,MAAMC,OAAO,GAAIC,UAAD,IAAgB;EAC5B,MAAMC,QAAQ,GAAGlB,MAAM,CAACmB,gBAAP,CAAwB,aAAxB,EAAsCb,MAAM,CAACC,IAAP,CAAYL,MAAZ,CAAtC,EAA0DI,MAAM,CAACC,IAAP,CAAYU,UAAU,CAACZ,EAAvB,EAA2B,KAA3B,CAA1D,CAAjB;EAEA,MAAMe,OAAO,GAAGd,MAAM,CAACM,MAAP,CAAc,CAACM,QAAQ,CAACL,MAAT,CAAgBP,MAAM,CAACC,IAAP,CAAYU,UAAU,CAACb,QAAvB,EAAgC,KAAhC,CAAhB,CAAD,EAAyDc,QAAQ,CAACJ,KAAT,EAAzD,CAAd,CAAhB;EAEA,OAAO;IAACO,CAAC,EAACD,OAAO,CAACL,QAAR,EAAH;IAAwBO,CAAC,EAACL,UAAU,CAACM;EAArC,CAAP;AACH,CAND;;AAQAC,MAAM,CAACC,OAAP,GAAiB;EAACtB,OAAD;EAAWa;AAAX,CAAjB"},"metadata":{},"sourceType":"module"}